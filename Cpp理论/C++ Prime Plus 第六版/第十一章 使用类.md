# **运算符重载**

- 运算符函数： `operatorop(argument-list)` ，op必须是有效的 `C++` 运算符

- 重载限制

  - 重载后的运算符至少有一个操作数是用户定义的类型

  - 左侧操作数必须是调用对象本身（友元无此限制）

  - 使用运算符不能违反运算符本来的句法规则和优先级

  - 不能重载以下运算符

    ![不可重载.png](http://120.77.180.209/2022/03/08/c330562dc09a9.png)

  - 可重载运算符

    ![可重载.png](http://120.77.180.209/2022/03/08/e4b5e923f10f6.png)

---

# **友元**

- 概念：类的友元（类、成员方法或函数）被赋予与类成员函数相同的访问权限

- 用于非成员重载函数：接受两个参数，不限制左侧操作数一定是调用对象本身

- 创建友元

  - 在原型声明之前加上 `friend` 关键字，定义时无需写关键字（除非函数内联）
  - 友元本身不属于类，不能使用成员运算符 `.` ，不使用限定符 `::` 定义

- 常用的友元：重载 `<<` 运算符

  - 理由：必须使用友元实现，第一个操作数时 `ostream` 对象而不是调用对象本身
  - 重载运算符函数：形参数目和运算符操作数要相同（成员函数版本则少一个，默认左侧为调用对象本身）

---

# **类的自动转换和强制类型转换**

- 关键字 `explicit` 

  - 关闭自动转换特性（隐式转换）
  - 只接受一个参数的构造函数定义了从参数类型到类类型的转换（生成临时对象）
  - 在构造函数的声明前使用，仍支持显式强制转换

- 转换函数

  - 特殊的 `C++` 运算符函数：用户定义的强制类型转换
  - 格式：`operator typeName();`
  - 转换函数必须是类方法，不能指定返回类型（隐式指明），不能有参数
  - 注意二义性：一种类型可以同时转换为多种类型时
  - 同样可以使用关键字 `explicit` 关闭这种隐式转换