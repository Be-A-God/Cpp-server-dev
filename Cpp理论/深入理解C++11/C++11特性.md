# **保持与 `C99` 的兼容**

- 预定义宏

  ![C++11特性-2022-03-14-22-58-39](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-14-22-58-39.png)

- `__func__` 预定义标识符：返回所在函数的名字；但是不允许作为默认形参

- `_Pragma` 操作符：`#pragma once` 等同条件编译防止重复包含头文件

- 变长参数的宏定义以及 `__VA_ARGS__` ：可以在宏定义实现替换省略号代表的字符串

- 宽窄字符串的连接：窄 `char` 转宽 `wchar_t` 再连接

- `long long int` 纳入标准库

- 宏 `__cplusplus` ，搭配 `extern "C"` 抑制C++的名称重整

- 断言：`assert()` 宏；定义 `NDEBUG` 禁用该断言

- 编译时断言：`static_assert()` ，接受两个参数：断言表达式（常量表达式）和警告信息

- `noexcept` ：弃用 `throw` 异常抛出

- 快速初始化成员变量：使用 `=` 或 `{}` 进行就地的非静态成员变量初始化

- 就地初始化和初始化列表不冲突，但初始化列表优先于就地初始化

- 支持对未实例化的类成员进行 `sizeof` 运算

- 声明友元类时可以不加 `class` 关键字，应用在模板类中

- `final/override` 关键字

- 模板函数的默认模板参数：为模板类型指定一个默认类型，默认类型必须从右到左

- 外部模板：在显式实例化前加上关键字 `extern` ，不会在此处实例化

- 局部和匿名类型作模板参数，但是不能直接将匿名结构体放入模板实参位置

---

# **通用性**

- 继承构造函数：直接调用基类的构造函数或者使用 `using` 声明使用基类的构造函数（基类的默认参数不会被继承，而是产生多个隐式构造函数）

- 委托构造函数：一个构造函数调用另一个构造函数；不支持同时使用列表初始化

- 右值引用：移动语义和完美转发

  - 常量左值引用可以绑定右值对象，因此常量右值引用基本无用
  - 完美转发确保类型传递一致，使用引用折叠规则；使用 `std::forward`

- 显式操作转换符：`explicit` 要求只能显式类型转换

- 列表初始化：`initializer_list` 自定义列表初始化；防止类型收窄

- `POD` 类型

- 非受限联合体：取消了对联合体数据成员类型的限制

- 用户自定义字面量：重载运算符 `""` 和指定后缀，会产生临时变量

  ![C++11特性-2022-03-14-23-27-24](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-14-23-27-24.png)

- 内联名字空间：`inline namespace` 声明内联名字空间（效果和匿名名字空间类似）

- 模板的别名：通常用 `typename` 为类型起别名，现在支持 `using` 起别名

- 一般化的 `SFINEA` 规则（不理解）

---

# **提高易用性**

- 右尖括号改进：不再需要加空格
- `auto` 类型推导
- `typeid` 返回变量相应的 `type_info` 数据， `type_info` 的 `name` 成员函数返回类型名字，新增 `hash_code` 成员函数返回类型唯一哈希值
- `decltype` 以表达式作为参数进行类型推导，参数使用括号包括时推导一定是引用类型
- `cv` 限定符：`auto` 会继承 `cv` 限定符， `decltype` 不会继承 `cv` 限定符
- 尾置返回类型
- 基于范围的 `for` 循环：标准库容器中, `auto` 声明的对象不是迭代器对象而是解引后的对象

---

# **提高类型安全**

- 强类型枚举：在 `enum` 关键字之后加上 `class` 关键字；使用 `:type` 指定底层类型
- 堆内存管理：三种智能指针

---

# **提高性能及操作硬件的能力**

- 常量表达式

  - 关键字 `constexpr` ，编译时检查
  - 常量表达式函数：只有单一的返回语句；必须返回值；使用前定义；返回语句必须是常量表达式
  - 常量表达式的构造函数要求：函数体为空；初始化列表只能由常量表达式赋值
  - 常量表达式用于函数模板时，如果实例化不满足要求，则忽略 `constexpr`
  - 常量表达式支持递归

- 变长模板

  - 语法：`template <typeName... Elements> class tuple;`
  - 解包：递归解包
  - 新运算符：`sizeof...()` 计算变长包的长度

- 原子类型与原子操作

  - 内存模型

    ![C++11特性-2022-03-15-18-16-58](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-15-18-16-58.png)

  - `atomic` 成员函数可以使用的内存模型

    ![C++11特性-2022-03-15-18-17-48](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-15-18-17-48.png)

- 线程局部存储

  - 全局、静态变量在多线程模型下总是在线程间共享
  - 使用 `thread_local` 关键字声明变量使得每个线程都有独立的变量拷贝
  - 线程独立变量的生命周期为线程的生命周期

- 快速退出

  - `quick_exit` 和 `at_quick_exit` ：前者退出程序；后者设置退出程序时要执行的注册函数
  - 属于正常退出，但是并不执行折构函数而是终止程序

---

# **新元素**

- 指针空值 `nullptr` ，不能进行取地址操作； `void *` 是无类型指针

- 默认函数的控制

  - 编译器默认生成

     ![C++11特性-2022-03-15-18-22-37](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-15-18-22-37.png)
     ![C++11特性-2022-03-15-18-23-04](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/C%2B%2B11%E7%89%B9%E6%80%A7-2022-03-15-18-23-04.png)

  - `= default` 关键字指定让编译器生成默认版本；`= delete` 关键字指明不声明函数的默认版本同时禁止该函数的使用

- `lambda` 函数：捕获列表不允许变量重复传递

  ![20220316172431](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/20220316172431.png)

  ![20220316172444](https://raw.githubusercontent.com/Be-A-God/Drawing-bed/main/note/20220316172444.png)

---

# **实际应用**

- 对齐支持

  - `alignof` 查询对齐方式
  - `alignas` 设定对齐方式
  - `align` 动态根据指定的对齐方式调整数据块的位置

- 通用属性

  - 形式： `[[attribute-list]]` 用于类型、变量、名称、代码块等
  - 两个通用属性：`[[noreturn]]` `[[carries_dependency]]`
  - 前者标识不会返回的函数（不等同没有返回值），不会返回到调用的前一级函数
  - 后者与弱内存模型平台有关

- `Unicode` 支持

  - `char16_t` 表示 `UTF-16` ，常量字符串前缀为 `u`
  - `char32_t` 表示 `UTF-32` ，常量字符串前缀为 `U`
  - `char` 表示 `UTF-8` ，常量字符串前缀为 `u8`

- 原声字符串字面量

  - 格式：`R"(String)"`
  - 可选分割符：`R"分割符(String)分割符"`
  - 遵循字符串连接规则
